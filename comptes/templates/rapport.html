<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <title>Rapport du Dashboard - Biblioth√®que</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
  <style>
    /* üîπ Reset et base */
    body {
      font-family: "Segoe UI", sans-serif;
      margin: 0;
      padding: 0;
      background: #fff;
      color: #2c3e50;
      line-height: 1.6;
      counter-reset: page;
    }

    /* üîπ Page */
    .page {
      page-break-after: always;
      min-height: 100vh;
      padding: 60px 50px 80px 50px;
      box-sizing: border-box;
      position: relative;
    }

    /* üîπ Pied de page num√©rotation automatique */
    .page-number {
      position: absolute;
      bottom: 20px;
      width: 100%;
      text-align: center;
      font-size: 0.85rem;
      color: #666;
    }
    .page-number::after {
      counter-increment: page;
      content: "Page " counter(page);
    }

    /* üîπ Titres */
    h1, h2, h3 {
      font-weight: 600;
      color: #1a1a1a;
      margin-bottom: 15px;
    }
    h2 {
      border-bottom: 2px solid #e5e5e5;
      padding-bottom: 6px;
      margin-bottom: 20px;
    }

    /* üîπ Couverture */
    .cover {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      height: 100vh;
      text-align: center;
      background: #fff;
      color: #1a1a1a;
    }
    .cover h1 { font-size: 2.2rem; margin-bottom: 15px; }
    .cover small { font-size: 1rem; opacity: 0.8; }

    /* üîπ KPI */
    .kpi-block {
      background: #fff;
      border: 1px solid #e0e0e0;
      border-radius: 8px;
      padding: 20px;
      text-align: center;
      box-shadow: 0 2px 6px rgba(0,0,0,0.04);
      margin-bottom: 20px;
    }
    .kpi-label { font-size: 0.85rem; color: #666; margin-top: 6px; }
    .kpi-value { font-size: 1.6rem; font-weight: 700; color: #0d47a1; }

    /* üîπ Graphiques */
    img.chart {
      width: 100%;
      height: auto;
      margin: 20px 0;
      border-radius: 6px;
      border: 1px solid #eee;
    }

    /* üîπ Analyse et recommandations */
    .analysis {
      font-size: 0.9rem;
      color: #444;
      margin-top: 10px;
    }
    .recommendations {
      background: #f9fbfd;
      border-left: 4px solid #0d47a1;
      padding: 15px;
      border-radius: 6px;
      margin-top: 10px;
    }
    .recommendations li { margin-bottom: 6px; }

  </style>
</head>
<body>

  <!-- üîπ PAGE DE GARDE -->
  <div class="cover">
    <img src="logo.png" alt="Logo" style="height:70px; margin-bottom: 20px;">
    <h1>Rapport d‚ÄôAnalyse ‚Äì Biblioth√®que</h1>
    <p>P√©riode couverte : <strong>Semaine / Mois</strong></p>
    <small>Date de g√©n√©ration : {{ today }}</small>
  </div>

  <!-- üîπ INTRODUCTION -->
  <div class="page">
    <h2><i class="bi bi-info-circle"></i> Introduction</h2>
    <p>
      Ce rapport pr√©sente une analyse d√©taill√©e de l‚Äôactivit√© de la biblioth√®que, couvrant deux √©chelles de temps :
      <strong>la semaine en cours et le mois en cours</strong>.  
      L‚Äôobjectif est de suivre l‚Äô√©volution de la fr√©quentation, des inscriptions et des emprunts, afin d‚Äôappuyer
      les d√©cisions strat√©giques concernant la gestion des usagers et des collections.
    </p>
    <div class="page-number"></div>
  </div>

  <!-- üîπ BILAN DE LA SEMAINE -->
  <div class="page">
    <h2><i class="bi bi-calendar-week"></i> Bilan de la Semaine</h2>
    <div class="row justify-content-center text-center mb-4">
      <div class="col-md-4"><div class="kpi-block"><div class="kpi-value">{{ data.semaine.total_inscriptions }}</div><div class="kpi-label">Inscriptions</div></div></div>
      <div class="col-md-4"><div class="kpi-block"><div class="kpi-value">{{ data.semaine.livres_empruntes }}</div><div class="kpi-label">Livres emprunt√©s</div></div></div>
      <div class="col-md-4"><div class="kpi-block"><div class="kpi-value">{{ data.semaine.livres_ajoutes }}</div><div class="kpi-label">Livres ajout√©s</div></div></div>
    </div>

    <h5 class="mt-3"><i class="bi bi-book"></i> Top 5 livres emprunt√©s</h5>
    <img src="data:image/png;base64,{{ top_livres_img }}" class="chart">
    <p class="analysis">
      Ce graphique montre les ouvrages les plus emprunt√©s cette semaine.
      <br><strong>Recommandation :</strong> veiller √† maintenir ces titres en stock et envisager l‚Äôacquisition
      d‚Äôexemplaires suppl√©mentaires pour √©viter la saturation.
    </p>
    <div class="page-number"></div>
  </div>

  <!-- üîπ BILAN DU MOIS -->
  <div class="page">
    <h2><i class="bi bi-calendar-month"></i> Bilan du Mois</h2>
    <div class="row justify-content-center text-center mb-4">
      <div class="col-md-4"><div class="kpi-block"><div class="kpi-value">{{ data.mois.total_inscriptions }}</div><div class="kpi-label">Inscriptions</div></div></div>
      <div class="col-md-4"><div class="kpi-block"><div class="kpi-value">{{ data.mois.total_emprunts }}</div><div class="kpi-label">Emprunts</div></div></div>
      <div class="col-md-4"><div class="kpi-block"><div class="kpi-value">{{ data.mois.taux_rdv_honores }}%</div><div class="kpi-label">RDV honor√©s</div></div></div>
    </div>

    <h5 class="mt-3"><i class="bi bi-people"></i> R√©partition des usagers</h5>
    <img src="data:image/png;base64,{{ usagers_img }}" class="chart">
    <p class="analysis">
      La r√©partition illustre les diff√©rents profils d‚Äôusagers.  
      <strong>Recommandation :</strong> renforcer la communication aupr√®s des groupes les moins repr√©sent√©s afin
      d‚Äô√©quilibrer la fr√©quentation et diversifier la communaut√©.
    </p>
    <div class="page-number"></div>
  </div>

  <!-- üîπ CONCLUSION -->
  <div class="page">
    <h2><i class="bi bi-lightbulb"></i> Conclusion & Recommandations</h2>
    <div class="recommendations">
      <ul>
        <li><i class="bi bi-megaphone text-primary"></i> Augmenter la communication cibl√©e pour attirer plus d‚Äôusagers.</li>
        <li><i class="bi bi-bookmark-star text-warning"></i> Surveiller la disponibilit√© des ouvrages les plus populaires.</li>
        <li><i class="bi bi-people text-success"></i> √âlargir la base d‚Äôusagers en valorisant les segments minoritaires.</li>
        <li><i class="bi bi-graph-up text-danger"></i> Suivre r√©guli√®rement les tendances pour ajuster la strat√©gie.</li>
      </ul>
    </div>
    <div class="page-number"></div>
  </div>

</body>
</html>
