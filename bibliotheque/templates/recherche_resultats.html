{% extends "base.html" %}
{% load static %}

{% block content %}
<div class="container" style="padding-top: 80px; padding-bottom: 100px;">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2>Résultats pour "{{ query|escape }}"</h2>
    {% if nombre_resultats > 0 %}
      <span class="badge bg-primary fs-6">{{ nombre_resultats }} résultat{{ nombre_resultats|pluralize }}</span>
    {% endif %}
  </div>

  {% if livres %}
    <div class="row gx-4 gy-4">
      {% for livre in livres %}
        <div class="col-12 col-sm-6 col-md-4 col-lg-3">
          <div class="card h-100 shadow-sm">
            {% if livre.image %}
              <img src="{{ livre.image }}" class="card-img-top" alt="Image de {{ livre.titre }}" style="height: 200px; object-fit: cover;">
            {% else %}
              <div class="card-img-top d-flex align-items-center justify-content-center bg-light" style="height: 200px;">
                <i class="bi bi-book text-muted" style="font-size: 3rem;"></i>
              </div>
            {% endif %}
            <div class="card-body d-flex flex-column">
              <h5 class="card-title">{{ livre.titre }}</h5>
              <p class="card-text">
                {% if livre.auteur %}
                  <strong>Auteur :</strong> {{ livre.auteur.nom }}{% if livre.auteur.prenom %} {{ livre.auteur.prenom }}{% endif %}
                {% else %}
                  <em>Auteur inconnu</em>
                {% endif %}
              </p>
              <p class="card-text">
                <small class="text-muted">
                  {% if livre.categorie %}
                    <strong>Catégorie :</strong> {{ livre.categorie.nom }}
                  {% endif %}
                </small>
              </p>
              <p class="card-text text-muted" style="font-size: 0.85rem;">
                <strong>Publié le :</strong> {{ livre.date_publication|date:"d/m/Y" }}
              </p>
              {% if livre.description %}
                <p class="card-text" style="font-size: 0.9rem;">
                  {{ livre.description|truncatewords:20 }}
                </p>
              {% endif %}
              
              <div class="mt-auto">
                {% if livre.categorie_id %}
                  <a href="{% url 'detail_livre' livre.categorie_id livre.id %}"
                     class="btn btn-primary btn-sm">
                    <i class="bi bi-eye me-1"></i>Consulter
                  </a>
                {% else %}
                <a href="#" class="btn btn-secondary disabled mt-auto">Catégorie inconnue</a>
              {% endif %}
            </div>
          </div>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <div class="text-center py-5">
      <i class="bi bi-search text-muted" style="font-size: 4rem;"></i>
      <h4 class="text-muted mt-3">Aucun livre trouvé</h4>
      <p class="text-muted">Aucun livre ne correspond à votre recherche "{{ query|escape }}"</p>
      <div class="mt-4">
        <a href="{% url 'catalogue' %}" class="btn btn-primary me-2">
          <i class="bi bi-book me-2"></i>Parcourir le catalogue
        </a>
        <a href="{% url 'accueil' %}" class="btn btn-outline-secondary">
          <i class="bi bi-house me-2"></i>Retour à l'accueil
        </a>
      </div>
    </div>
  {% endif %}
</div>
{% endblock %}


